# ğŸ“¸ æ‹ç…§å’Œå½•åƒåŠŸèƒ½

## åŠŸèƒ½æ¦‚è¿°

ä¸ºAppFlowy Editorçš„å¤šåª’ä½“å·¥å…·æ æ·»åŠ äº†å®Œæ•´çš„æ‹ç…§å’Œå½•åƒåŠŸèƒ½ï¼Œç”¨æˆ·ç°åœ¨å¯ä»¥ï¼š

- ğŸ“· **ç›´æ¥æ‹ç…§**ï¼šä½¿ç”¨è®¾å¤‡ç›¸æœºæ‹æ‘„ç…§ç‰‡å¹¶æ’å…¥ç¼–è¾‘å™¨
- ğŸ¥ **å½•åˆ¶è§†é¢‘**ï¼šå½•åˆ¶è§†é¢‘å†…å®¹å¹¶è‡ªåŠ¨æ·»åŠ åˆ°æ–‡æ¡£ä¸­
- ğŸ–¼ï¸ **é€‰æ‹©å›¾ç‰‡**ï¼šä»ç›¸å†Œä¸­é€‰æ‹©ç°æœ‰ç…§ç‰‡ï¼ˆæ”¯æŒå¤šé€‰ï¼‰
- ğŸ“¹ **é€‰æ‹©è§†é¢‘**ï¼šä»ç›¸å†Œä¸­é€‰æ‹©ç°æœ‰è§†é¢‘æ–‡ä»¶
- âš¡ **é«˜è´¨é‡æ‹ç…§**ï¼šæ‹æ‘„é«˜åˆ†è¾¨ç‡ç…§ç‰‡
- ğŸ¬ **é•¿è§†é¢‘å½•åˆ¶**ï¼šå½•åˆ¶é•¿æ—¶é—´è§†é¢‘å†…å®¹

## æ–°å¢åŠŸèƒ½

### 1. æ ‡å‡†å¤šåª’ä½“å·¥å…·æ ï¼ˆå·²æ›´æ–°ï¼‰

åŸæœ‰çš„ `multimediaMobileToolbarItem` ç°åœ¨åŒ…å«4ä¸ªé€‰é¡¹ï¼š

```dart
// ç¬¬ä¸€è¡Œï¼šé€‰æ‹©ç°æœ‰åª’ä½“
- é€‰æ‹©å›¾ç‰‡ï¼ˆä»ç›¸å†Œï¼‰
- é€‰æ‹©è§†é¢‘ï¼ˆä»ç›¸å†Œï¼‰

// ç¬¬äºŒè¡Œï¼šæ‹æ‘„æ–°åª’ä½“  
- æ‹ç…§ï¼ˆä½¿ç”¨ç›¸æœºï¼‰
- å½•åƒï¼ˆä½¿ç”¨ç›¸æœºï¼‰
```

### 2. å¢å¼ºç‰ˆå¤šåª’ä½“å·¥å…·æ ï¼ˆæ–°å¢ï¼‰

æ–°çš„ `enhancedMultimediaMobileToolbarItem` æä¾›6ä¸ªé€‰é¡¹ï¼š

```dart
// æ‹æ‘„åŠŸèƒ½
- æ‹ç…§ï¼ˆæ ‡å‡†è´¨é‡ï¼‰
- å½•åƒï¼ˆ5åˆ†é’Ÿé™åˆ¶ï¼‰

// é€‰æ‹©åŠŸèƒ½
- é€‰æ‹©å›¾ç‰‡ï¼ˆå¤šé€‰æ”¯æŒï¼‰
- é€‰æ‹©è§†é¢‘ï¼ˆå•é€‰ï¼‰

// é«˜çº§åŠŸèƒ½
- é«˜è´¨é‡æ‹ç…§ï¼ˆ4Kåˆ†è¾¨ç‡ï¼‰
- é•¿è§†é¢‘å½•åˆ¶ï¼ˆ30åˆ†é’Ÿé™åˆ¶ï¼‰
```

## æŠ€æœ¯å®ç°

### æ‹ç…§åŠŸèƒ½
```dart
Future<void> _handleTakePhoto() async {
  try {
    final XFile? photo = await _picker.pickImage(
      source: ImageSource.camera,
      maxWidth: 1920,
      maxHeight: 1080,
      imageQuality: 85,
    );

    if (photo != null) {
      await _insertMediaFile(photo, 'image');
      _showSuccessMessage('ç…§ç‰‡å·²æ·»åŠ ');
    }
  } catch (e) {
    _handleCameraError(e, 'æ‹ç…§');
  }
}
```

### å½•åƒåŠŸèƒ½
```dart
Future<void> _handleRecordVideo() async {
  try {
    final XFile? video = await _picker.pickVideo(
      source: ImageSource.camera,
      maxDuration: const Duration(minutes: 5),
    );

    if (video != null) {
      await _insertMediaFile(video, 'video');
      _showSuccessMessage('è§†é¢‘å·²æ·»åŠ ');
    }
  } catch (e) {
    _handleCameraError(e, 'å½•åƒ');
  }
}
```

### é«˜è´¨é‡æ‹ç…§
```dart
Future<void> _handleTakeHighQualityPhoto() async {
  final XFile? photo = await _picker.pickImage(
    source: ImageSource.camera,
    maxWidth: 4096,  // 4Kåˆ†è¾¨ç‡
    maxHeight: 4096,
    imageQuality: 95, // é«˜è´¨é‡
  );
}
```

### é•¿è§†é¢‘å½•åˆ¶
```dart
Future<void> _handleRecordLongVideo() async {
  final XFile? video = await _picker.pickVideo(
    source: ImageSource.camera,
    maxDuration: const Duration(minutes: 30), // 30åˆ†é’Ÿé™åˆ¶
  );
}
```

## æƒé™å¤„ç†

### è‡ªåŠ¨æƒé™æ£€æŸ¥
- è‡ªåŠ¨æ£€æµ‹ç›¸æœºæƒé™çŠ¶æ€
- æ™ºèƒ½æç¤ºç”¨æˆ·æˆæƒæƒé™
- æä¾›æƒé™è®¾ç½®é¡µé¢è·³è½¬

### é”™è¯¯å¤„ç†
```dart
void _handleCameraError(dynamic error, String action) {
  String errorMessage = '$actionå¤±è´¥';
  if (error.toString().contains('permission')) {
    errorMessage = 'ç›¸æœºæƒé™è¢«æ‹’ç»ï¼Œè¯·åœ¨è®¾ç½®ä¸­å…è®¸åº”ç”¨è®¿é—®ç›¸æœº';
  } else if (error.toString().contains('No camera available')) {
    errorMessage = 'è®¾å¤‡æ²¡æœ‰å¯ç”¨çš„ç›¸æœº';
  }
  
  _showErrorMessage(errorMessage);
}
```

### æƒé™å·¥å…·ç±»
æ–°å¢ `CameraPermissionHelper` å·¥å…·ç±»ï¼š

```dart
// æ£€æŸ¥å¹¶è¯·æ±‚ç›¸æœºæƒé™
await CameraPermissionHelper.ensureCameraPermission(context);

// æ£€æŸ¥å¹¶è¯·æ±‚å­˜å‚¨æƒé™
await CameraPermissionHelper.ensureStoragePermission(context);

// æ˜¾ç¤ºæƒé™çŠ¶æ€
await CameraPermissionHelper.showPermissionStatus(context);

// æ‰“å¼€åº”ç”¨è®¾ç½®
await CameraPermissionHelper.openAppSettings();
```

## ç”¨æˆ·ç•Œé¢

### æ ‡å‡†ç‰ˆç•Œé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é€‰æ‹©å›¾ç‰‡    â”‚    é€‰æ‹©è§†é¢‘          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    æ‹ç…§      â”‚      å½•åƒ            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¢å¼ºç‰ˆç•Œé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ·»åŠ åª’ä½“                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              æ‹æ‘„                    â”‚
â”‚    æ‹ç…§      â”‚      å½•åƒ            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            ä»ç›¸å†Œé€‰æ‹©                â”‚
â”‚  é€‰æ‹©å›¾ç‰‡    â”‚    é€‰æ‹©è§†é¢‘          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            é«˜çº§é€‰é¡¹                  â”‚
â”‚ é«˜è´¨é‡æ‹ç…§   â”‚   é•¿è§†é¢‘å½•åˆ¶         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä½¿ç”¨æ–¹æ³•

### åŸºç¡€ä½¿ç”¨
```dart
MobileToolbarV2(
  editorState: editorState,
  toolbarItems: [
    multimediaMobileToolbarItem, // æ ‡å‡†ç‰ˆ
    // å…¶ä»–å·¥å…·æ é¡¹...
  ],
  child: AppFlowyEditor(editorState: editorState),
)
```

### å¢å¼ºç‰ˆä½¿ç”¨
```dart
MobileToolbarV2(
  editorState: editorState,
  toolbarItems: [
    enhancedMultimediaMobileToolbarItem, // å¢å¼ºç‰ˆ
    // å…¶ä»–å·¥å…·æ é¡¹...
  ],
  child: AppFlowyEditor(editorState: editorState),
)
```

## åŠŸèƒ½ç‰¹æ€§

### åª’ä½“è´¨é‡æ§åˆ¶
- **æ ‡å‡†æ‹ç…§**ï¼š1920x1080ï¼Œ85%è´¨é‡
- **é«˜è´¨é‡æ‹ç…§**ï¼š4096x4096ï¼Œ95%è´¨é‡
- **æ ‡å‡†å½•åƒ**ï¼š5åˆ†é’Ÿé™åˆ¶
- **é•¿è§†é¢‘å½•åˆ¶**ï¼š30åˆ†é’Ÿé™åˆ¶

### å¤šé€‰æ”¯æŒ
- å›¾ç‰‡é€‰æ‹©æ”¯æŒå¤šé€‰
- æ‰¹é‡æ’å…¥å¤šä¸ªå›¾ç‰‡
- ç»Ÿä¸€çš„æˆåŠŸæç¤º

### é”™è¯¯å¤„ç†
- æƒé™è¢«æ‹’ç»çš„å‹å¥½æç¤º
- è®¾å¤‡æ— ç›¸æœºçš„é”™è¯¯å¤„ç†
- ç½‘ç»œæˆ–å­˜å‚¨é”™è¯¯çš„å¤„ç†

### ç”¨æˆ·ä½“éªŒ
- ç›´è§‚çš„å›¾æ ‡è®¾è®¡
- æ¸…æ™°çš„åŠŸèƒ½åˆ†ç±»
- å³æ—¶çš„æ“ä½œåé¦ˆ
- æƒé™å¼•å¯¼æµç¨‹

## ä¾èµ–è¦æ±‚

ç¡®ä¿åœ¨ `pubspec.yaml` ä¸­æ·»åŠ å¿…è¦ä¾èµ–ï¼š

```yaml
dependencies:
  image_picker: ^1.0.4
  
# å¯é€‰ï¼šç”¨äºæ›´å¥½çš„æƒé™å¤„ç†
  permission_handler: ^11.0.1
```

## å¹³å°æ”¯æŒ

- âœ… **iOS**ï¼šå®Œæ•´æ”¯æŒæ‰€æœ‰åŠŸèƒ½
- âœ… **Android**ï¼šå®Œæ•´æ”¯æŒæ‰€æœ‰åŠŸèƒ½
- âŒ **Web**ï¼šä¸æ”¯æŒç›¸æœºåŠŸèƒ½
- âŒ **Desktop**ï¼šä¸æ”¯æŒç›¸æœºåŠŸèƒ½

## æœ€ä½³å®è·µ

1. **æƒé™å¤„ç†**ï¼šåœ¨ä½¿ç”¨å‰æ£€æŸ¥å¹¶è¯·æ±‚å¿…è¦æƒé™
2. **é”™è¯¯å¤„ç†**ï¼šæä¾›å‹å¥½çš„é”™è¯¯æç¤ºå’Œè§£å†³æ–¹æ¡ˆ
3. **ç”¨æˆ·å¼•å¯¼**ï¼šé¦–æ¬¡ä½¿ç”¨æ—¶æä¾›åŠŸèƒ½è¯´æ˜
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆç†è®¾ç½®å›¾ç‰‡è´¨é‡å’Œè§†é¢‘æ—¶é•¿é™åˆ¶
5. **å­˜å‚¨ç®¡ç†**ï¼šåŠæ—¶æ¸…ç†ä¸´æ—¶æ–‡ä»¶

## æ€»ç»“

æ–°å¢çš„æ‹ç…§å’Œå½•åƒåŠŸèƒ½ä¸ºAppFlowy Editoræä¾›äº†å®Œæ•´çš„å¤šåª’ä½“å†…å®¹åˆ›ä½œèƒ½åŠ›ã€‚ç”¨æˆ·ç°åœ¨å¯ä»¥ï¼š

- ğŸš€ **å¿«é€Ÿåˆ›ä½œ**ï¼šç›´æ¥æ‹æ‘„å†…å®¹æ— éœ€åˆ‡æ¢åº”ç”¨
- ğŸ“± **ç§»åŠ¨ä¼˜åŒ–**ï¼šä¸“ä¸ºç§»åŠ¨è®¾å¤‡è®¾è®¡çš„äº¤äº’ä½“éªŒ
- ğŸ¯ **ç²¾ç¡®æ§åˆ¶**ï¼šå¤šç§è´¨é‡å’Œæ—¶é•¿é€‰é¡¹
- ğŸ”’ **å®‰å…¨å¯é **ï¼šå®Œå–„çš„æƒé™å¤„ç†å’Œé”™è¯¯ç®¡ç†
- ğŸ¨ **çµæ´»é…ç½®**ï¼šæ ‡å‡†ç‰ˆå’Œå¢å¼ºç‰ˆæ»¡è¶³ä¸åŒéœ€æ±‚

è¿™äº›åŠŸèƒ½ä½¿AppFlowy Editoræˆä¸ºçœŸæ­£çš„ç§»åŠ¨ç«¯å†…å®¹åˆ›ä½œå¹³å°ï¼Œä¸ºç”¨æˆ·æä¾›äº†ä»æ–‡å­—åˆ°å¤šåª’ä½“çš„å®Œæ•´ç¼–è¾‘ä½“éªŒã€‚
